@model BobaShop.Web.Models.ProductViewModel
@{
    ViewData["Title"] = @Model.Name;
}

<div class="container py-4">
    <div class="row g-4 align-items-center">
        <!-- Left side: product image -->
        <div class="col-md-5 text-center">
            <img src="@Model.ImageUrl"
                 alt="@Model.Name"
                 class="img-fluid shadow-sm"
                 style="max-height: 350px; border-radius: 1rem; background: var(--surface, #F3E8FF);" />
        </div>

        <!-- Right side: product details -->
        <div class="col-md-7">
            <h2 class="fw-bold" style="color: var(--brand, #8B5CF6);">@Model.Name</h2>
            <p class="text-muted">@Model.Description</p>
            <h4 class="fw-semibold mb-3">@Model.Price.ToString("C2")</h4>

            <form asp-controller="Cart" asp-action="Add" method="post" class="p-3 rounded shadow-sm" style="background: var(--surface, #F3E8FF);">
                @Html.AntiForgeryToken()

                <!-- Hidden fields -->
                <input type="hidden" name="ProductId" value="@Model.Id" />
                <input type="hidden" name="Name" value="@Model.Name" />
                <input type="hidden" name="UnitPrice" value="@Model.Price" />

                <!-- Size selection -->
                <div class="mb-3">
                    <label class="form-label fw-semibold">Size</label>
                    <select class="form-select" name="Size" required>
                        <option value="Regular">Regular</option>
                        <option value="Large">Large (+$1.00)</option>
                    </select>
                </div>

                <!-- Sugar & Ice sliders -->
                <div class="row mb-3">
                    <div class="col">
                        <label class="form-label fw-semibold">Sugar</label>
                        <select class="form-select" name="Sugar" required>
                            <option value="0">0%</option>
                            <option value="25">25%</option>
                            <option value="50" selected>50%</option>
                            <option value="75">75%</option>
                            <option value="100">100%</option>
                        </select>
                    </div>
                    <div class="col">
                        <label class="form-label fw-semibold">Ice</label>
                        <select class="form-select" name="Ice" required>
                            <option value="0">0%</option>
                            <option value="25">25%</option>
                            <option value="50" selected>50%</option>
                            <option value="75">75%</option>
                            <option value="100">100%</option>
                        </select>
                    </div>
                </div>

                <!-- Toppings -->
                <div class="mb-3">
                    <label class="form-label fw-semibold">Toppings</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="ToppingsSummary" value="Pearls" id="tPearls" />
                        <label class="form-check-label" for="tPearls">Pearls</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="ToppingsSummary" value="Coconut Jelly" id="tCoconut" />
                        <label class="form-check-label" for="tCoconut">Coconut Jelly</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="ToppingsSummary" value="Pudding" id="tPudding" />
                        <label class="form-check-label" for="tPudding">Pudding</label>
                    </div>
                </div>

                <!-- Quantity -->
                <div class="mb-3">
                    <label class="form-label fw-semibold">Quantity</label>
                    <input type="number" name="Quantity" value="1" min="1" class="form-control" style="max-width: 100px;" />
                </div>

                <!-- Buttons -->
                <div class="d-flex gap-2">
                    <button type="submit"
                            class="btn btn-primary"
                            style="background: var(--brand, #8B5CF6); border: none; border-radius: .75rem;">
                        Add to Cart
                    </button>
                    <a asp-controller="Products"
                       asp-action="Index"
                       class="btn btn-outline-secondary"
                       style="border-radius: .75rem;">
                        Back to Menu
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // fallback if image fails
        document.querySelectorAll("img").forEach(img => {
            img.addEventListener("error", () => img.src = "/images/drinks/placeholder.png");
        });
    </script>
}
